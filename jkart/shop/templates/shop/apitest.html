{% extends 'shop/basic.html' %}


{% block title %}Checking the cloud api{% endblock %}


{% block body %}

<form id="file-form">
    <div class="input-group">
        <input type="file" class="form-control" id="file" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
        <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04">Submit</button>
    </div>
    <input type="submit" value="Submit">
</form>
{% endblock %}

{% block script %}

<script>
    let file;
    const fileSize = (s) => {
        const byteSize = { 0: "Bytes", 1: "KB", 2: "MB", 3: "GB" }
        return s;
    }

    $('#file').change((event) => {
        file = event.target.files[0];
        console.log(event.target.files[0])
        // setTimeout(() => {
        //     setsize(fileSize(event.target.files[0].size))
        // }, 500);
        console.log("on select", file);
    });
    $('#file-form').submit(async (event) => {
        event.preventDefault();
        let formData = new FormData();
        formData.append('file', file);
        console.log("on submit", formData);
        const data = await fetch('http://127.0.0.1:8000/api/files/', {
            method: "POST",
            body: formData
        })
        const jsondata = await data.json();
        console.log(file, jsondata);
    });

</script>
{% endblock %}